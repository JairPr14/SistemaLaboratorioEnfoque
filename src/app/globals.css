@import "tailwindcss";

/* Dark mode: activar con clase .dark en html */
@custom-variant dark (&:where(.dark, .dark *));

:root {
  --background: 255 255 255;
  --foreground: 15 23 42;
  --muted: 241 245 249;
  --muted-foreground: 100 116 139;
  --border: 226 232 240;
  --primary: 15 23 42;
  --primary-foreground: 248 250 252;
  --danger: 220 38 38;
  --accent: 20 184 166; /* teal-500 */
  --accent-foreground: 255 255 255;
  --radius: 0.75rem;
  --radius-sm: 0.5rem;
  --transition: 180ms ease;
  --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.04);
  --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.06), 0 1px 2px -1px rgb(0 0 0 / 0.04);
  --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.06), 0 2px 4px -2px rgb(0 0 0 / 0.04);
}

.dark {
  --background: 15 23 42;
  --foreground: 248 250 252;
  --muted: 30 41 59;
  --muted-foreground: 148 163 184;
  --border: 51 65 85;
  --primary: 248 250 252;
  --primary-foreground: 15 23 42;
  --danger: 239 68 68;
  --accent: 45 212 191; /* teal-400 */
  --accent-foreground: 15 23 42;
  --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.2);
  --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.25);
  --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.2), 0 2px 4px -2px rgb(0 0 0 / 0.15);
}

@theme inline {
  --color-background: rgb(var(--background));
  --color-foreground: rgb(var(--foreground));
  --color-muted: rgb(var(--muted));
  --color-muted-foreground: rgb(var(--muted-foreground));
  --color-border: rgb(var(--border));
  --color-primary: rgb(var(--primary));
  --color-primary-foreground: rgb(var(--primary-foreground));
  --color-danger: rgb(var(--danger));
  --color-accent: rgb(var(--accent));
  --color-accent-foreground: rgb(var(--accent-foreground));
}

html {
  scroll-behavior: smooth;
}

body {
  background: rgb(var(--background));
  color: rgb(var(--foreground));
  font-family: "Inter", system-ui, -apple-system, sans-serif;
  transition: background-color 0.25s ease, color 0.25s ease;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Oculta scrollbar manteniendo scroll (sidebar, etc.) */
.scrollbar-hide {
  -ms-overflow-style: none;
  scrollbar-width: none;
}
.scrollbar-hide::-webkit-scrollbar {
  display: none;
}


/* Estilos para selects en modo oscuro */
.dark select {
  background-color: rgb(30 41 59) !important;
  color: rgb(248 250 252) !important;
}

.dark select option {
  background-color: rgb(30 41 59) !important;
  color: rgb(248 250 252) !important;
}

/* Sin encabezado ni pie de página del navegador (evita URL y "1/1") */
@page {
  size: A4;
  margin: 0;
}

/* Ticket de pago: formato A4 */
@page ticket-a4 {
  size: A4;
  margin: 10mm;
}

/* Ticket de pago: formato 80mm (térmico) */
@page ticket-80mm {
  size: 80mm auto;
  margin: 2mm;
}

@media print {
  /* Incluir fondos e imágenes al imprimir/guardar como PDF */
  * {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }

  /* Evitar scroll al imprimir: ocultar overflow en html y body */
  html,
  body {
    overflow: hidden !important;
    height: auto !important;
  }

  aside,
  header,
  nav,
  footer,
  button:not(.print-keep) {
    display: none !important;
  }

  /* Mantener el encabezado del informe (área en blanco) para que no se desencuadre */
  .print-a4 header {
    display: flex !important;
  }

  main {
    padding: 0 !important;
    margin: 0 !important;
    overflow: visible !important;
  }

  /* Evitar hoja en blanco: contenedor principal sin min-height que fuerce página extra */
  body > div {
    min-height: 0 !important;
  }

  body {
    background: white;
    color: black;
    font-size: 12pt;
    margin: 0 !important;
    padding: 0 !important;
  }

  .print-page {
    page-break-after: always;
  }

  .print-avoid-break {
    page-break-inside: avoid;
  }

  /* Hoja A4: altura fija para que el contenido escalado quepa en una hoja */
  .print-a4 {
    width: 210mm !important;
    height: 297mm !important;
    min-height: 297mm !important;
    max-width: 210mm !important;
    box-sizing: border-box;
  }

  /* Barra de sección: fondo semi-transparente visible al imprimir/PDF */
  .print-section-bar {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }

  /* Sello virtual: incluir al imprimir */
  .print-stamp img,
  .print-stamp-img,
  .print-stamp-overlay .print-stamp-img {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }

  /* Marco de agua: tamaño fijo A4 en impresión */
  .print-watermark {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    position: absolute !important;
    top: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    left: 0 !important;
    z-index: 0 !important;
    width: 210mm !important;
    height: 297mm !important;
    min-width: 210mm !important;
    min-height: 297mm !important;
    object-fit: contain !important;
    object-position: center !important;
    opacity: 1 !important;
  }

  /* Evitar que el contenido del informe se parta en dos páginas */
  .print-a4-content {
    page-break-inside: avoid;
  }

  table {
    page-break-inside: auto;
  }

  tr {
    page-break-inside: avoid;
    page-break-after: auto;
  }

  thead {
    display: table-header-group;
  }

  tfoot {
    display: table-footer-group;
  }

  /* Ticket de pago: formato A4 */
  body.print-ticket-a4 .print-ticket-content {
    page: ticket-a4;
  }

  body.print-ticket-a4 .print-ticket-inner {
    max-width: 210mm;
  }

  /* Ticket de pago: formato 80mm térmico */
  body.print-ticket-80mm .print-ticket-content {
    page: ticket-80mm;
  }

  body.print-ticket-80mm .print-ticket-inner {
    width: 76mm !important;
    max-width: 76mm !important;
    min-width: 76mm !important;
    padding: 4mm !important;
    font-size: 10px !important;
  }

  body.print-ticket-80mm .print-ticket-inner h1 {
    font-size: 12px !important;
  }

  body.print-ticket-80mm .print-ticket-inner p,
  body.print-ticket-80mm .print-ticket-inner li {
    font-size: 9px !important;
  }
}

/* Forzar padding-top en vista impresión (evita que se ignore por colapso o transform) */
.print-a4-content-padding {
  padding-top: 400px !important;
  box-sizing: border-box;
}

/* Tabla de reporte hematología: columnas fijas, sin overflow */
.print-report-table {
  table-layout: fixed;
  width: 100%;
  border-collapse: collapse;
  box-sizing: border-box;
}

.print-report-table,
.print-report-table * {
  box-sizing: border-box;
}

.print-report-table th,
.print-report-table td {
  padding: 0.4rem 0.6rem;
  vertical-align: top;
  overflow: hidden;
  border: 1px solid rgb(203 213 225);
  font-size: 10px;
}

.print-report-table thead th {
  background: #f1f5f9;
  font-weight: 700;
}

/* Col 1: ANÁLISIS - 42% */
.print-report-table .col-analisis {
  width: 42%;
  min-width: 0;
  word-break: break-word;
  overflow-wrap: break-word;
}

/* Col 2: RESULTADOS - 16% */
.print-report-table .col-resultados {
  width: 16%;
  min-width: 0;
  text-align: center;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* Col 3: UNIDAD - 12% */
.print-report-table .col-unidad {
  width: 12%;
  min-width: 0;
  text-align: center;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* Col 4: VALOR REFERENCIAL - 30% */
.print-report-table .col-valor-ref {
  width: 30%;
  min-width: 0;
  word-break: break-word;
  overflow-wrap: break-word;
}

/* Footer con firma: evitar que se parta */
.print-footer-block {
  page-break-inside: avoid;
}

/* =============================
   Nuevo modulo vista impresion
   ============================= */
/* Cada página A4 fija: el watermark mantiene siempre el mismo tamaño */
.print-html-page {
  width: 210mm;
  height: 297mm;
  min-height: 297mm;
  max-height: 297mm;
  max-width: 210mm;
  box-sizing: border-box;
  overflow: hidden;
  background: white;
  position: relative;
}

/* Marco de agua: tamaño fijo en todas las hojas (210x297mm) */
.print-watermark {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: 0;
  width: 210mm;
  height: 297mm;
  min-width: 210mm;
  min-height: 297mm;
  object-fit: contain;
  object-position: center;
  opacity: 1;
  pointer-events: none;
  user-select: none;
}

/* Logo lab terciarizado: zona central del header (entre logo clínica y eslogan) */
.print-referred-lab-header {
  position: absolute;
  top: 50px;
  down: 80px;
  left: 0px;
  right: 0px;
  height: 110px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 6px;
  z-index: 1;
  pointer-events: none;
  user-select: none;
  transform: translateX(45px);
}

.print-referred-lab-label {
  font-size: 10px;
  font-weight: 600;
  color: #334155;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.print-referred-lab-logo {
  max-height: 50px;
  max-width: 100px;
  width: auto;
  height: auto;
  object-fit: contain;
}

/* Área de contenido: respeta zona superior (header) y inferior (datos clínica en watermark) */
.print-html-content {
  position: relative;
  z-index: 1;
  padding: 178px 16mm 65mm;
  box-sizing: border-box;
  min-height: 260mm;
}

/* Grid paciente: fila1 PACIENTE|SEXO, fila2 EDAD|DNI|FECHA, fila3 INDICACIÓN|N°REGISTRO */
.print-patient-grid {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 2px 24px;
  font-size: 11px;
  margin-bottom: 8px;
  line-height: 1.4;
}

.print-patient-grid .label {
  font-weight: 700;
}

.print-analisis-label {
  font-weight: 700;
  font-size: 11px;
  margin-bottom: 4px;
}

.print-section-title {
  border: 1px solid #0f172a;
  padding: 4px 10px;
  text-align: center;
  font-weight: bold ;
  font-size: 18px;
  margin-bottom: 10px;
  background: #f8fafc;
}

/* Permitir que el bloque se divida para evitar hojas vacías (evitar solo en filas de tabla) */
.print-analysis-block {
  margin-bottom: 10px;
  break-inside: auto;
  page-break-inside: auto;
}

.print-analysis-name {
  font-weight: 700;
  margin-bottom: 2px;
}

.print-group-row td {
  background: #f1f5f9;
  font-weight: 700;
}

/* Descripción del parámetro debajo del valor referencial */
.print-valor-ref {
  vertical-align: top !important;
}

.print-param-description {
  font-size: 9px;
  color: #475569;
  margin-top: 4px;
  line-height: 1.35;
  font-weight: normal;
}

.print-page-footer {
  padding-top: 12px;
  border-top: 1px solid #e2e8f0;
  font-size: 10px;
}

/* Sello y firma: solo en última hoja, encima del contenido a la derecha, sin tapar texto */
.print-stamp-overlay {
  position: absolute;
  bottom: 20mm;
  right: 12mm;
  z-index: 2;
  pointer-events: none;
  user-select: none;
  display: flex;
  justify-content: flex-end;
  align-items: flex-end;
}

.print-stamp-img {
  max-width: 250px;
  max-height: 150px;
  width: auto;
  height: auto;
  object-fit: contain;
  pointer-events: none;
  user-select: none;
  opacity: 0.82;
}

@media print {
  .print-toolbar {
    display: none !important;
  }

  .print-module-root {
    background: white !important;
    padding: 0 !important;
  }

  .print-html-page {
    margin: 0 auto !important;
    box-shadow: none !important;
    page-break-after: always;
  }

  .print-html-page:last-child {
    page-break-after: auto;
  }
}
